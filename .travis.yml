language: python

dist: xenial
sudo: required

python:
  - '3.5'
  - '3.6'
  - '3.7'
  - 'pypy3.5'

install:
  - pip install -e .[dev]

script:
  - pytest --cov

after_success:
  # Report to codecov, with different flags for tests.
  - coverage xml --include 'loguru/*'
  - codecov -f coverage.xml --flags loguru "py${TRAVIS_PYTHON_VERSION//./}" --disable search gcov pycov
  - coverage xml --include 'tests/*'
  - codecov -f coverage.xml --flags tests "py${TRAVIS_PYTHON_VERSION//./}" --disable search gcov pycov

  - cd docs && make html
